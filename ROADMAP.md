# オルテンシア 开发路线图

## 📊 当前状态：Phase 1 完成 ✅

**版本**: 1.0.0  
**完成度**: 70%  
**核心功能**: ✅ 可用

---

## ✅ Phase 1: 核心系统搭建（已完成）

### 1.1 基础架构 ✅
- [x] VRM 模型加载和渲染
- [x] Electron 透明悬浮窗
- [x] Next.js + React 前端框架
- [x] Python WebSocket 后端

### 1.2 通信系统 ✅
- [x] WebSocket 双向通信
- [x] 客户端-服务器架构
- [x] 消息广播机制
- [x] 连接管理和重连

### 1.3 情绪系统 ✅
- [x] 事件到情绪的映射引擎
- [x] 36 种编程事件定义
- [x] 6 种基础情绪（neutral, happy, sad, angry, relaxed, surprised）
- [x] 情绪驱动的动画
- [x] 情绪配置文件（YAML）

### 1.4 动画系统 ✅
- [x] VRM BlendShape 表情控制
- [x] 身体动画控制（头部、身体旋转）
- [x] EmoteController 集成
- [x] 情绪驱动的动作

### 1.5 TTS 系统 ✅
- [x] macOS 系统 TTS 集成
- [x] 5 种少女音色（Meijia, Sinji, Tingting, Flo, Sandy）
- [x] 情绪驱动的语速调整
- [x] AIFF → WAV 格式转换
- [x] 可插拔 TTS 架构
- [x] TTS 配置管理（JSON）

### 1.6 测试和文档 ✅
- [x] WebSocket 测试脚本
- [x] 事件触发测试
- [x] Chrome 浏览器测试
- [x] 完整技术文档
- [x] 快速开始指南

### 1.7 项目管理 ✅
- [x] Git 仓库初始化
- [x] 代码整理和清理
- [x] 推送到远程仓库
- [x] 启动/停止脚本

---

## 🚧 Phase 2: Cursor IDE 深度集成（核心任务）

**优先级**: 🔴 最高  
**预计时间**: 2-3 天

### 2.1 Cursor IDE 事件钩子 ⏳
- [ ] **研究 Cursor IDE 扩展 API**
  - [ ] 调研 Cursor 扩展开发文档
  - [ ] 确定可用的事件钩子
  - [ ] 测试事件捕获能力

- [ ] **实现文件操作钩子**
  - [ ] 文件保存事件（`onDidSaveTextDocument`）
  - [ ] 文件创建事件（`onDidCreateFiles`）
  - [ ] 文件删除事件（`onDidDeleteFiles`）
  - [ ] 文件重命名事件

- [ ] **实现 Git 操作钩子**
  - [ ] Git commit 事件
  - [ ] Git push 事件
  - [ ] Git merge 事件
  - [ ] Git conflict 检测

- [ ] **实现 AI 操作钩子**
  - [ ] AI 补全开始/结束
  - [ ] AI 建议接受/拒绝
  - [ ] AI 生成代码事件

- [ ] **实现错误检测钩子**
  - [ ] 语法错误（Linter）
  - [ ] 运行时错误（Debug Console）
  - [ ] 构建错误（Task Output）

- [ ] **实现测试钩子**
  - [ ] 测试运行事件
  - [ ] 测试通过/失败
  - [ ] 覆盖率变化

### 2.2 Cursor 扩展开发 ⏳
- [ ] **创建扩展项目**
  ```
  cursorgirl-extension/
  ├── package.json
  ├── tsconfig.json
  ├── src/
  │   ├── extension.ts      # 扩展入口
  │   ├── eventHandler.ts   # 事件处理
  │   ├── websocket.ts      # WebSocket 客户端
  │   └── config.ts         # 配置管理
  └── README.md
  ```

- [ ] **实现事件监听器**
  - [ ] 注册所有 VSCode/Cursor API 事件
  - [ ] 事件过滤和防抖
  - [ ] 事件优先级处理

- [ ] **实现 WebSocket 客户端**
  - [ ] 自动连接到 bridge
  - [ ] 断线重连
  - [ ] 心跳检测

- [ ] **配置管理**
  - [ ] 扩展设置界面
  - [ ] WebSocket 服务器地址配置
  - [ ] 启用/禁用特定事件
  - [ ] 音量和频率控制

- [ ] **打包和发布**
  - [ ] 本地测试
  - [ ] 打包为 `.vsix`
  - [ ] 发布到 Cursor 扩展市场（可选）

### 2.3 用户体验优化 ⏳
- [ ] **状态栏图标**
  - [ ] 显示オルテンシア连接状态
  - [ ] 快速开关功能
  - [ ] 点击打开设置

- [ ] **通知系统**
  - [ ] 连接成功/失败提示
  - [ ] 重要事件通知
  - [ ] 可配置的通知级别

---

## 🎨 Phase 3: 增强功能（次要任务）

**优先级**: 🟡 中等  
**预计时间**: 1-2 周

### 3.1 更多 TTS 引擎 ⏳
- [ ] **Edge TTS 集成**
  - [ ] 实现 EdgeTTS 类
  - [ ] 测试在中国的可用性
  - [ ] 添加配置支持

- [ ] **Azure TTS 集成**
  - [ ] 实现 AzureTTS 类
  - [ ] Azure China 区域支持
  - [ ] API 密钥管理

- [ ] **Google TTS 集成**
  - [ ] 实现 GoogleTTS 类
  - [ ] 代理支持
  - [ ] 备用方案

- [ ] **本地 TTS（ChatTTS/PaddleSpeech）**
  - [ ] 解决 Mac ARM 兼容性问题
  - [ ] 模型下载和管理
  - [ ] 性能优化

### 3.2 多语言支持 ⏳
- [ ] **英文 TTS**
  - [ ] 英文音色配置
  - [ ] 语言自动检测

- [ ] **日文 TTS**
  - [ ] 日文音色配置
  - [ ] 日语发音优化

- [ ] **多语言消息**
  - [ ] 消息模板多语言化
  - [ ] 用户语言偏好设置

### 3.3 表情和动画优化 ⏳
- [ ] **更丰富的表情**
  - [ ] 支持更多 BlendShape 表情
  - [ ] 表情组合和过渡
  - [ ] 表情强度控制

- [ ] **自定义动作**
  - [ ] 加载 `.vrma` 动画文件
  - [ ] 动画序列编排
  - [ ] 动画库管理

- [ ] **动作录制**
  - [ ] 录制自定义动作
  - [ ] 动作导出和分享

### 3.4 模型管理 ⏳
- [ ] **模型切换**
  - [ ] 支持多个 VRM 模型
  - [ ] 模型预览
  - [ ] 在线下载模型

- [ ] **模型定制**
  - [ ] 颜色和服装配置
  - [ ] 饰品和道具
  - [ ] 模型导入向导

---

## 🚀 Phase 4: 高级功能（未来计划）

**优先级**: 🟢 低  
**预计时间**: 待定

### 4.1 语音识别 ⏳
- [ ] **语音输入**
  - [ ] 麦克风输入
  - [ ] 语音识别（Whisper）
  - [ ] 实时转写

- [ ] **双向对话**
  - [ ] 语音命令识别
  - [ ] 自然语言处理
  - [ ] 上下文理解

### 4.2 AI 对话增强 ⏳
- [ ] **LLM 集成**
  - [ ] GPT-4 API
  - [ ] 本地 LLM（Ollama）
  - [ ] 对话上下文管理

- [ ] **智能回复**
  - [ ] 根据代码内容生成回复
  - [ ] 编程建议
  - [ ] 错误解释

### 4.3 数据分析 ⏳
- [ ] **编程统计**
  - [ ] 每日编码时间
  - [ ] 语言使用统计
  - [ ] 效率分析

- [ ] **可视化**
  - [ ] 图表和报告
  - [ ] 趋势分析
  - [ ] 成就系统

### 4.4 社区功能 ⏳
- [ ] **分享和导出**
  - [ ] 动画录制和导出
  - [ ] GIF/视频生成
  - [ ] 社交媒体分享

- [ ] **模型商店**
  - [ ] 社区模型库
  - [ ] 模型评分和评论
  - [ ] 付费模型支持

---

## 📋 最近 2 周优先级任务

### Week 1: Cursor IDE 基础集成
**目标**: 实现基本的 Cursor 扩展，捕获文件保存、Git 操作等核心事件

#### Day 1-2: 研究和准备
- [ ] 阅读 Cursor/VSCode 扩展开发文档
- [ ] 搭建扩展开发环境
- [ ] 创建扩展项目骨架

#### Day 3-4: 核心事件实现
- [ ] 实现文件操作钩子（保存、创建、删除）
- [ ] 实现 WebSocket 客户端
- [ ] 本地测试

#### Day 5-7: Git 和 AI 事件
- [ ] 实现 Git 操作钩子
- [ ] 实现 AI 操作钩子（如果可用）
- [ ] 完整测试

### Week 2: 错误检测和优化
**目标**: 实现错误检测，优化用户体验

#### Day 8-10: 错误和测试钩子
- [ ] 实现 Linter 错误监听
- [ ] 实现测试运行监听
- [ ] 调试和优化

#### Day 11-12: 用户体验
- [ ] 添加状态栏图标
- [ ] 实现配置界面
- [ ] 通知系统

#### Day 13-14: 打包和文档
- [ ] 完善文档
- [ ] 打包扩展
- [ ] 发布到内部测试

---

## 🎯 核心目标

### 短期目标（1个月内）
1. ✅ 完成基础系统（已完成）
2. 🔴 **完成 Cursor IDE 扩展开发**（当前重点）
3. 🟡 至少集成 2 种 TTS 引擎

### 中期目标（3个月内）
1. 完善所有事件钩子
2. 优化动画和表情系统
3. 实现多语言支持
4. 发布 1.0 正式版

### 长期目标（6个月+）
1. 语音识别和双向对话
2. AI 对话增强
3. 社区功能和模型商店
4. 商业化探索

---

## 📊 关键指标

### 技术指标
- **代码覆盖率**: 目标 80%+
- **响应延迟**: < 100ms
- **稳定性**: 99%+ 正常运行时间
- **性能**: CPU < 5%, 内存 < 200MB

### 用户指标
- **用户数**: 目标 100+ 内测用户
- **日活**: 目标 50+
- **满意度**: 目标 4.5/5.0
- **反馈响应**: < 24小时

---

## 🛠️ 技术债务

### 当前已知问题
- [ ] Electron 窗口在某些系统上可能不透明
- [ ] TTS 音频播放偶尔会有延迟
- [ ] WebSocket 重连逻辑需要优化
- [ ] 日志系统需要统一管理

### 代码优化
- [ ] 前端代码需要更多 TypeScript 类型
- [ ] Python 代码需要添加类型注解
- [ ] 测试覆盖率需要提升
- [ ] 性能监控和分析工具

---

## 📝 决策记录

### 已做出的重要决策
1. **使用 macOS TTS** - 因为稳定可靠，音质好
2. **可插拔 TTS 架构** - 方便后续替换和扩展
3. **WebSocket 通信** - 实时性好，易于扩展
4. **身体动画替代表情** - 因为模型缺少 BlendShape 数据
5. **Git 仓库推送** - 使用公司内部 Git 服务器

### 待决策事项
- [ ] 是否开源？（建议先内部使用，成熟后开源）
- [ ] 是否支持 Windows/Linux？（建议 Phase 3）
- [ ] 是否开发移动端？（建议 Phase 4）
- [ ] 付费模式？（建议免费 + 高级功能付费）

---

## 🎉 里程碑

- ✅ **2025-10-30**: 项目启动，VRM 模型显示成功
- ✅ **2025-10-30**: WebSocket 通信系统完成
- ✅ **2025-10-31**: 情绪映射系统完成
- ✅ **2025-11-01**: TTS 系统集成完成
- ✅ **2025-11-01**: Phase 1 完成，代码推送到 Git
- ⏳ **2025-11-15**: Phase 2 完成，Cursor 扩展发布（目标）
- ⏳ **2025-12-01**: Phase 3 完成，多 TTS 和多语言支持（目标）
- ⏳ **2026-01-01**: 1.0 正式版发布（目标）

---

**当前状态**: Phase 1 完成 ✅  
**下一步**: 开始 Phase 2 - Cursor IDE 扩展开发 🚀

🎊 **オルテンシア 已经可以说话和表达情绪了！现在让她真正理解你的编程过程吧！**

